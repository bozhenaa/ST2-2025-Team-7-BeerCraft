@model BeerCraftMVC.Models.ViewModels.Recipes.RecipeDetailViewModel
@{
    ViewData["Title"] = Model.Name;
}
@section Styles {
    <link rel="stylesheet" href="~/css/details.css" />
    <link rel="stylesheet" href="~/css/second_layout.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" integrity="sha512-Fo3rlrZj/k7ujTnHg4CGR2D7kSs0v4LLanw2qksYuRlEzO+tcaEPQogQ0KaoGN26/zrn20ImR1DfuLWnOo7aBA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
}

<div class="details-container">
    <article class="details-card">

        <header class="details-header">
            <div class="title-like-wrapper">
                <h1>@Model.Name</h1>

                @if (User.Identity != null && User.Identity.IsAuthenticated)
                {
                    <form asp-action="LikeRecipe" asp-route-id="@Model.Id" method="post" class="like-form">
                        @Html.AntiForgeryToken()

                        @if (Model.IsLikedByCurrentUser)
                        {
                            <button type="submit" class="btn-like liked" title="Click to unlike this recipe">
                                <i class="fa-duotone fa-solid fa-heart"></i>
                            </button>
                        }
                        else
                        {
                            <button type="submit" class="btn-like not-liked" title="Click to like this recipe">
                                <i class="fa-duotone fa-solid fa-heart"></i>
                            </button>
                        }
                    </form>
                }
            </div>
            
            <div class="recipe-meta">
                <span>By: <strong>@Model.AuthorUsername</strong></span>
                <span>On: <time datetime="@Model.CreatedAt.ToString("yyyy-MM-dd")">@Model.CreatedAt.ToString("MMM dd, yyyy")</time></span>
            </div>
        </header>

        <section class="recipe-full-description">
            <p>@Html.Raw(Model.Description?.Replace(Environment.NewLine, "<br />"))</p>
        </section>

        <hr class="recipe-divider" />

        <section class="ingredients-section">
            <h2>Ingredients</h2>
            @if (Model.Ingredients.Any())
            {
                <ul class="ingredient-list">
                    @foreach (var ingredient in Model.Ingredients)
                    {
                        <li>
                            <span class="ingredient-name">@ingredient.IngredientName</span>
                            <span class="ingredient-quantity">@ingredient.Quantity @ingredient.Unit</span>
                            <span class="ingredient-type">(@ingredient.IngredientTypeName)</span>
                        </li>
                    }
                </ul>
            }
            else
            {
                <p>This recipe doesn't have any ingredients listed.</p>
            }
        </section>

        <footer class="details-actions">
            <a asp-action="Index" class="btn btn-secondary">Back to all recipes</a>
           

            @if (User.Identity != null && User.Identity.Name == Model.AuthorUsername)
            {
               
                <form asp-action="Delete" asp-route-id="@Model.Id" method="post" onsubmit="return confirm('Are you sure you want to delete this recipe?');">
                    @Html.AntiForgeryToken()
                    <button type="submit" class="btn btn-danger">Delete</button>
                </form>
            }
        </footer>

    </article>
</div>